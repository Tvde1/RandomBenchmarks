using System.Text.Json;
using System.Text.Json.Serialization;
using BenchmarkDotNet.Attributes;
using BenchmarkDotNet.Jobs;

namespace ParseJsonSubset;

[SimpleJob(RuntimeMoniker.Net70)]
[MemoryDiagnoser(false)]
public class Benchmark
{
    private const string ShortData = @"{""firstvalue"": 1,""secondvalue"": 2}";
    private const string LongData =
        @"{""firstvalue"": 1,""Data"": [{""_id"": ""634419f97bd668b984cbe568"",""index"": 0,""guid"": ""249c7426-4ad1-4657-988b-05be9e7dc0f2"",""isActive"": false,""balance"": ""$1,070.77"",""picture"": ""http://placehold.it/32x32"",""age"": 36,""eyeColor"": ""blue"",""name"": ""Juarez Ramsey"",""gender"": ""male"",""company"": ""ZOLAVO"",""email"": ""juarezramsey@zolavo.com"",""phone"": ""+1 (985) 441-2302"",""address"": ""174 Hart Place, Diaperville, South Dakota, 1401"",""about"": ""Deserunt deserunt sit sunt cillum dolore velit ex velit nostrud. Elit officia minim exercitation est mollit ut exercitation laborum culpa est exercitation minim. Labore pariatur fugiat in mollit reprehenderit nisi et Lorem nisi reprehenderit elit officia. Lorem velit commodo Lorem sit. Mollit veniam reprehenderit eiusmod consequat nisi sit reprehenderit non velit exercitation sit sit in. Culpa eu velit qui adipisicing enim est sunt magna tempor proident dolor. Voluptate officia dolor sint cillum.\r\n"",""registered"": ""2015-02-23T08:59:34 -01:00"",""latitude"": 29.154403,""longitude"": -69.716631,""tags"": [""nisi"",""ullamco"",""nostrud"",""nisi"",""est"",""sit"",""nostrud"",""ullamco"",""veniam"",""voluptate"",""nisi"",""incididunt"",""eu"",""cillum"",""dolor"",""labore"",""in"",""do"",""esse"",""ullamco"",""anim"",""occaecat"",""commodo"",""ullamco"",""commodo"",""esse"",""dolore"",""magna"",""cupidatat"",""est"",""aute"",""ipsum"",""ea"",""consequat"",""eu"",""mollit"",""tempor"",""incididunt"",""commodo"",""velit"",""tempor"",""cupidatat"",""nulla"",""aliquip"",""pariatur"",""laboris"",""eu"",""consectetur"",""eu"",""laborum"",""elit"",""adipisicing"",""nulla"",""ipsum"",""labore"",""culpa"",""cillum"",""deserunt"",""dolor"",""elit"",""tempor"",""nostrud"",""elit"",""elit"",""mollit"",""nostrud"",""cillum"",""excepteur"",""laborum"",""in"",""nostrud"",""sunt"",""eiusmod"",""eiusmod"",""nulla"",""aliqua"",""dolor"",""anim"",""esse"",""duis"",""aliqua"",""voluptate"",""adipisicing"",""quis"",""magna"",""magna"",""ullamco"",""velit"",""enim"",""incididunt"",""consequat"",""nulla"",""est"",""tempor"",""in"",""deserunt"",""velit"",""fugiat"",""eiusmod"",""sit"",""nisi"",""nulla"",""ex"",""aute"",""culpa"",""tempor"",""ullamco"",""amet"",""ex"",""aliqua"",""dolore"",""tempor"",""dolore"",""eu"",""ullamco"",""consequat"",""elit"",""dolor"",""est"",""adipisicing"",""dolor"",""reprehenderit"",""aliquip"",""mollit"",""voluptate"",""exercitation"",""consequat"",""deserunt"",""commodo"",""cillum"",""deserunt"",""amet"",""id"",""ut"",""eiusmod"",""occaecat"",""cillum"",""occaecat"",""quis"",""culpa"",""anim"",""sint"",""non"",""Lorem"",""consectetur"",""duis"",""elit"",""non"",""eu"",""nostrud"",""quis"",""id"",""mollit"",""sit"",""proident"",""laborum"",""et"",""irure"",""non"",""ut"",""nisi"",""pariatur"",""eiusmod"",""nisi"",""quis"",""ut"",""qui"",""nulla"",""enim"",""tempor""],""friends"": [{""id"": 0,""name"": ""Sykes Durham""},{""id"": 1,""name"": ""Maura Emerson""},{""id"": 2,""name"": ""Rodriquez Mcpherson""},{""id"": 3,""name"": ""Martin Acosta""},{""id"": 4,""name"": ""Myra Hale""},{""id"": 5,""name"": ""Ethel Davidson""},{""id"": 6,""name"": ""Beck Marquez""},{""id"": 7,""name"": ""Esmeralda Strickland""},{""id"": 8,""name"": ""Marshall Byrd""},{""id"": 9,""name"": ""Trudy Boyer""},{""id"": 10,""name"": ""Marilyn Mckee""},{""id"": 11,""name"": ""Rosales Hall""},{""id"": 12,""name"": ""Howell Christian""},{""id"": 13,""name"": ""Amparo Madden""},{""id"": 14,""name"": ""Donna Browning""},{""id"": 15,""name"": ""Walsh Goodwin""},{""id"": 16,""name"": ""Queen Key""},{""id"": 17,""name"": ""Gilda Wood""},{""id"": 18,""name"": ""Ewing Sanchez""},{""id"": 19,""name"": ""Lambert Gilmore""},{""id"": 20,""name"": ""Pate Booth""},{""id"": 21,""name"": ""Peters Carlson""},{""id"": 22,""name"": ""Stuart Riddle""},{""id"": 23,""name"": ""Grant Love""},{""id"": 24,""name"": ""Jenifer Martin""},{""id"": 25,""name"": ""Summer Estes""},{""id"": 26,""name"": ""Burke Maddox""},{""id"": 27,""name"": ""Marguerite Mcclure""},{""id"": 28,""name"": ""Morrow Lindsay""},{""id"": 29,""name"": ""Silvia Parker""}],""greeting"": ""Hello, Juarez Ramsey! You have 8 unread messages."",""favoriteFruit"": ""banana""},{""_id"": ""634419f95d0081c60274107c"",""index"": 1,""guid"": ""ba269fc5-97de-45eb-a51c-129c9cc5298a"",""isActive"": false,""balance"": ""$1,831.68"",""picture"": ""http://placehold.it/32x32"",""age"": 27,""eyeColor"": ""blue"",""name"": ""Baker Snow"",""gender"": ""male"",""company"": ""WAZZU"",""email"": ""bakersnow@wazzu.com"",""phone"": ""+1 (963) 520-3060"",""address"": ""408 Garfield Place, Topaz, Mississippi, 1344"",""about"": ""Minim irure enim nostrud cupidatat aliquip eu fugiat pariatur officia. Velit ea aliquip excepteur Lorem ex proident ipsum irure dolore reprehenderit dolore. Occaecat nisi irure commodo sunt non. Consequat exercitation reprehenderit excepteur officia cillum qui sunt Lorem Lorem eu pariatur laboris. Incididunt nisi fugiat irure sint minim elit aliqua. Consectetur deserunt incididunt eu dolore commodo irure ea duis nisi et exercitation aliqua.\r\n"",""registered"": ""2016-02-22T06:27:21 -01:00"",""latitude"": -18.701106,""longitude"": -176.933728,""tags"": [""irure"",""labore"",""adipisicing"",""excepteur"",""non"",""minim"",""laborum"",""consequat"",""consequat"",""dolore"",""ea"",""et"",""quis"",""quis"",""aute"",""excepteur"",""velit"",""occaecat"",""cupidatat"",""labore"",""veniam"",""ad"",""non"",""ut"",""velit"",""dolor"",""qui"",""enim"",""cupidatat"",""non"",""nulla"",""eu"",""ipsum"",""tempor"",""ex"",""irure"",""ad"",""officia"",""nulla"",""laborum"",""esse"",""enim"",""culpa"",""ut"",""tempor"",""laborum"",""cupidatat"",""pariatur"",""anim"",""commodo"",""fugiat"",""Lorem"",""amet"",""cillum"",""sunt"",""elit"",""pariatur"",""voluptate"",""mollit"",""in"",""dolor"",""sunt"",""ad"",""sit"",""ea"",""pariatur"",""excepteur"",""velit"",""officia"",""minim"",""eiusmod"",""tempor"",""cillum"",""commodo"",""excepteur"",""mollit"",""consequat"",""sunt"",""qui"",""laboris"",""labore"",""in"",""est"",""fugiat"",""amet"",""excepteur"",""enim"",""enim"",""sunt"",""consectetur"",""mollit"",""culpa"",""anim"",""elit"",""tempor"",""eiusmod"",""labore"",""tempor"",""id"",""sit"",""fugiat"",""Lorem"",""eiusmod"",""do"",""deserunt"",""adipisicing"",""minim"",""consequat"",""eiusmod"",""minim"",""esse"",""qui"",""minim"",""magna"",""sint"",""veniam"",""ipsum"",""ex"",""dolore"",""commodo"",""aliquip"",""cillum"",""reprehenderit"",""do"",""consequat"",""do"",""nisi"",""fugiat"",""cillum"",""laboris"",""ut"",""ut"",""ipsum"",""sunt"",""et"",""ex"",""elit"",""nulla"",""ipsum"",""aute"",""magna"",""sit"",""dolor"",""id"",""ex"",""pariatur"",""duis"",""mollit"",""aute"",""occaecat"",""culpa"",""exercitation"",""minim"",""nostrud"",""nisi"",""excepteur"",""aliqua"",""laborum"",""officia"",""nulla"",""mollit"",""consectetur"",""id"",""ullamco"",""quis"",""quis"",""elit"",""duis"",""sint"",""aliquip""],""friends"": [{""id"": 0,""name"": ""June Pollard""},{""id"": 1,""name"": ""Kathie Chaney""},{""id"": 2,""name"": ""Peggy Franklin""},{""id"": 3,""name"": ""Angelia Gonzales""},{""id"": 4,""name"": ""Nellie Dominguez""},{""id"": 5,""name"": ""Dotson Cook""},{""id"": 6,""name"": ""Velez Navarro""},{""id"": 7,""name"": ""Tyler Bowen""},{""id"": 8,""name"": ""Tracy Bradshaw""},{""id"": 9,""name"": ""Meredith Walsh""},{""id"": 10,""name"": ""Paul Craft""},{""id"": 11,""name"": ""Blake Sharp""},{""id"": 12,""name"": ""Tillman Alvarez""},{""id"": 13,""name"": ""Matilda Pena""},{""id"": 14,""name"": ""Conner Sloan""},{""id"": 15,""name"": ""Margie Mckay""},{""id"": 16,""name"": ""Cantrell Warner""},{""id"": 17,""name"": ""Cain Nicholson""},{""id"": 18,""name"": ""Marta Joseph""},{""id"": 19,""name"": ""Kristi Noble""},{""id"": 20,""name"": ""Dennis Mccormick""},{""id"": 21,""name"": ""Kathleen Hubbard""},{""id"": 22,""name"": ""Kasey Rhodes""},{""id"": 23,""name"": ""Brewer Orr""},{""id"": 24,""name"": ""Stacey Calderon""},{""id"": 25,""name"": ""Wade Cortez""},{""id"": 26,""name"": ""Catherine Rice""},{""id"": 27,""name"": ""Doyle Blake""},{""id"": 28,""name"": ""Wilcox Witt""},{""id"": 29,""name"": ""Shannon Talley""}],""greeting"": ""Hello, Baker Snow! You have 6 unread messages."",""favoriteFruit"": ""apple""}],""secondvalue"": 2}";

    [Params(ShortData, LongData)] 
    public string Input;

    [Benchmark(Baseline = true)]
    public JsonData? WithoutPropertyName()
    {
        return JsonSerializer.Deserialize<JsonData>(Input);
    }
    
    [Benchmark]
    public JsonDataWithPropertyName? WithPropertyName()
    {
        return JsonSerializer.Deserialize<JsonDataWithPropertyName>(Input);
    }
}

public class JsonData
{
    public int FirstValue { get; set; }
    public int SecondValue { get; set; }
}

public class JsonDataWithPropertyName
{
    [JsonPropertyName("firstvalue")]
    public int FirstValue { get; set; }
    [JsonPropertyName("secondvalue")]
    public int SecondValue { get; set; }
}
